\doxysection{rpp\+::schedulers\+::current\+\_\+thread Class Reference}
\hypertarget{classrpp_1_1schedulers_1_1current__thread}{}\label{classrpp_1_1schedulers_1_1current__thread}\index{rpp::schedulers::current\_thread@{rpp::schedulers::current\_thread}}


Schedules execution of schedulables via queueing tasks to the caller thread with priority to time\+\_\+point and order.  




{\ttfamily \#include $<$current\+\_\+thread.\+hpp$>$}

\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classrpp_1_1schedulers_1_1current__thread_1_1worker__strategy}{worker\+\_\+strategy}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{classrpp_1_1schedulers_1_1current__thread_ab162580f09159ee410d0e169f879fadc}\label{classrpp_1_1schedulers_1_1current__thread_ab162580f09159ee410d0e169f879fadc} 
static utils\+::finally\+\_\+action$<$ void(\texorpdfstring{$\ast$}{*})()$>$ {\bfseries own\+\_\+queue\+\_\+and\+\_\+drain\+\_\+finally\+\_\+if\+\_\+not\+\_\+owned} ()
\item 
\Hypertarget{classrpp_1_1schedulers_1_1current__thread_ae605523439b20eff649499d40bdd459a}\label{classrpp_1_1schedulers_1_1current__thread_ae605523439b20eff649499d40bdd459a} 
static \mbox{\hyperlink{classrpp_1_1schedulers_1_1worker}{rpp\+::schedulers\+::worker}}$<$ \mbox{\hyperlink{classrpp_1_1schedulers_1_1current__thread_1_1worker__strategy}{worker\+\_\+strategy}} $>$ {\bfseries create\+\_\+worker} ()
\end{DoxyCompactItemize}
\doxysubsubsection*{Friends}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{classrpp_1_1schedulers_1_1current__thread_a53d37bfcfcc778c31d8ff80250e4d004}\label{classrpp_1_1schedulers_1_1current__thread_a53d37bfcfcc778c31d8ff80250e4d004} 
class {\bfseries new\+\_\+thread}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Schedules execution of schedulables via queueing tasks to the caller thread with priority to time\+\_\+point and order. 

\begin{DoxyWarning}{Warning}
Caller thread is thread where {\ttfamily schedule} called.
\end{DoxyWarning}
When this scheduler passed to some operators, then caller thread is thread where scheduling of some action happens. In most cases it is where {\ttfamily on\+\_\+next} was called.

\begin{DoxyParagraph}{Why do we need it?}
This scheduler used to prevent recursion calls and making planar linear execution of schedulables. For example\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{auto}\ worker\ =\ rpp::schedulers::current\_thread::create\_worker();}
\DoxyCodeLine{worker.schedule([\&worker](\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ observer)}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Task\ 1\ starts"{}}\ <<\ std::endl;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ worker.schedule([\&worker](\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ observer)}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Task\ 2\ starts"{}}\ <<\ std::endl;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ worker.schedule([](\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Task\ 4"{}}\ <<\ std::endl;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ rpp::schedulers::optional\_duration\{\};}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \},\ observer);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Task\ 2\ ends"{}}\ <<\ std::endl;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ rpp::schedulers::optional\_duration\{\};}
\DoxyCodeLine{\ \ \ \ \},\ observer);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ worker.schedule([](\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&)}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Task\ 3"{}}\ <<\ std::endl;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ rpp::schedulers::optional\_duration\{\};}
\DoxyCodeLine{\ \ \ \ \},\ observer);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Task\ 1\ ends"{}}\ <<\ std::endl;}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{return}\ rpp::schedulers::optional\_duration\{\};}
\DoxyCodeLine{\},\ observer);}

\end{DoxyCode}
 Would lead to\+:
\begin{DoxyItemize}
\item \"{}\+Task 1 starts\"{}
\item \"{}\+Task 1 ends\"{}
\item \"{}\+Task 2 starts\"{}
\item \"{}\+Task 2 ends\"{}
\item \"{}\+Task 3\"{}
\item \"{}\+Task 4\"{}
\end{DoxyItemize}
\end{DoxyParagraph}
\begin{DoxyParagraph}{How to use it properly?}
To have any visible impact you need to use it at least {\bfseries{twice}} during same observable. For example, {\ttfamily \doxylink{group__creational__operators_gae60bdb9b493443d2786b0eee8bfe17ab}{rpp\+::source\+::just}} source uses it as default scheduler as well as {\ttfamily \doxylink{group__combining__operators_ga3f8a04b4c8eb945534eddde5a25eec74}{rpp\+::operators\+::merge}} operator (which just \"{}owns\"{} it during subscription).
\end{DoxyParagraph}
For example, this one 
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{group__creational__operators_gae60bdb9b493443d2786b0eee8bfe17ab}{rpp::source::just}}(1,\ 2,\ 3)\ }
\DoxyCodeLine{\ |\ \mbox{\hyperlink{group__combining__operators_ga063bcb64ac3afbedca8b257d3558f2dd}{rpp::operators::merge\_with}}(\mbox{\hyperlink{group__creational__operators_gae60bdb9b493443d2786b0eee8bfe17ab}{rpp::source::just}}(4,\ 5,\ 6))\ }
\DoxyCodeLine{\ |\ \mbox{\hyperlink{group__utility__operators_ga149309d4b2e0f1201f1ab42597ace8ac}{rpp::operators::subscribe}}([](\textcolor{keywordtype}{int}\ v)\ \{\ std::cout\ <<\ v\ <<\ \textcolor{stringliteral}{"{}\ "{}};\ \});}

\end{DoxyCode}
 Procedes output {\ttfamily 1 4 2 5 3 6} due to {\ttfamily merge\+\_\+with} takes ownership over this scheduler during subscription, both sources schedule their first emissions into scheduler, then {\ttfamily merge\+\_\+with} frees scheduler and it starts to proceed scheduled actions. As a result it continues interleaving of values. In case of usingg {\ttfamily \doxylink{classrpp_1_1schedulers_1_1immediate}{rpp\+::schedulers\+::immediate}} it would be\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{group__creational__operators_gae60bdb9b493443d2786b0eee8bfe17ab}{rpp::source::just}}(\mbox{\hyperlink{classrpp_1_1schedulers_1_1immediate}{rpp::schedulers::immediate}}\{\},\ 1,\ 2,\ 3)\ }
\DoxyCodeLine{\ |\ \mbox{\hyperlink{group__combining__operators_ga063bcb64ac3afbedca8b257d3558f2dd}{rpp::operators::merge\_with}}(\mbox{\hyperlink{group__creational__operators_gae60bdb9b493443d2786b0eee8bfe17ab}{rpp::source::just}}(\mbox{\hyperlink{classrpp_1_1schedulers_1_1immediate}{rpp::schedulers::immediate}}\{\},\ 4,\ 5,\ 6))\ }
\DoxyCodeLine{\ |\ \mbox{\hyperlink{group__utility__operators_ga149309d4b2e0f1201f1ab42597ace8ac}{rpp::operators::subscribe}}([](\textcolor{keywordtype}{int}\ v)\ \{\ std::cout\ <<\ v\ <<\ \textcolor{stringliteral}{"{}\ "{}};\ \});}

\end{DoxyCode}
 With output {\ttfamily 1 2 3 4 5 6} \begin{Desc}
\item[Examples]\par
\mbox{\hyperlink{from_8cpp-example}{from.\+cpp}}, and \mbox{\hyperlink{just_8cpp-example}{just.\+cpp}}.\end{Desc}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
src/rpp/rpp/schedulers/current\+\_\+thread.\+hpp\end{DoxyCompactItemize}
